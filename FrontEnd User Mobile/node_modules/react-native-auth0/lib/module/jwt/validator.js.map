{"version":3,"names":["AuthError","verifySignature","DEFAULT_LEEWAY","verifyToken","idToken","options","Promise","resolve","domain","then","payload","validateClaims","opts","iss","reject","idTokenError","error","desc","sub","aud","Array","isArray","includes","clientId","join","now","_clock","getEpochTimeInSeconds","Date","leeway","exp","expTime","iat","nonce","orgId","org_id","length","azp","maxAge","auth_time","authValidUntil","date","Math","round","getTime","arguments","undefined","json","error_description","status"],"sourceRoot":"../../../src","sources":["jwt/validator.ts"],"mappings":"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"}
