{"version":3,"names":["_authError","_interopRequireDefault","require","_rsaVerifier","base64","_interopRequireWildcard","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","jwtDecoder","ALLOWED_ALGORITHMS","verifySignature","idToken","options","header","payload","err","Promise","reject","idTokenError","error","alg","includes","resolve","getJwk","domain","kid","then","jwk","rsaVerifier","rsaVerifierForKey","encodedParts","split","headerAndPayload","signature","decodeToHEX","verify","exports","modulus","n","exponent","e","RSAVerifier","getJwksUri","uri","fetchJson","keys","filter","k","use","kty","find","Error","catch","fetch","resp","json","openIdConfig","jwks_uri","AuthError","error_description","status"],"sourceRoot":"../../../src","sources":["jwt/signatureVerifier.ts"],"mappings":"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"}
