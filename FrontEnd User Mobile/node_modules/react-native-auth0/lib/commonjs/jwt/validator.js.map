{"version":3,"names":["_authError","_interopRequireDefault","require","_signatureVerifier","obj","__esModule","default","DEFAULT_LEEWAY","verifyToken","idToken","options","Promise","resolve","verifySignature","domain","then","payload","validateClaims","exports","opts","iss","reject","idTokenError","error","desc","sub","aud","Array","isArray","includes","clientId","join","now","_clock","getEpochTimeInSeconds","Date","leeway","exp","expTime","iat","nonce","orgId","org_id","length","azp","maxAge","auth_time","authValidUntil","date","Math","round","getTime","arguments","undefined","AuthError","json","error_description","status"],"sourceRoot":"../../../src","sources":["jwt/validator.ts"],"mappings":"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"}
